<!doctype html>
<html lang="{{ .Site.LanguageCode }}" class="text-neutral-900 antialiased">
  {{- partial "head.html" . -}}
  <body class="font-ja bg-neutral-50 text-neutral-900">
    <div class="grid min-h-screen grid-rows-[auto_1fr_auto]">
      <div class="container mx-auto w-full px-4 md:px-6">
        {{- partial "header.html" . -}}
      </div>

      <div class="container mx-auto w-full px-2 py-4 md:px-6 md:py-6">
        <div
          class="grid grid-cols-1 items-start gap-8 lg:grid-cols-[280px_1fr_240px]"
        >
          <!-- Left Sidebar -->
          {{- partial "notes/sidebar.html" . -}}
          <!-- Main Content -->
          <main class="min-w-0">
            {{- block "main" . }}{{- end }}
          </main>
          <!-- Right Sidebar (TOC) -->
          <aside
            class="sticky top-24 hidden h-[calc(100vh-8rem)] overflow-y-auto lg:block"
          >
            <div class="space-y-4">
              <h3 class="text-sm font-semibold text-neutral-900">
                On this page
              </h3>
              <div class="toc text-sm text-neutral-500">
                {{ .TableOfContents }}
              </div>
            </div>
          </aside>
        </div>
      </div>
    </div>
    {{- partial "drawer-script.html" -}}
    <script src="/js/instantpage-5.2.0.js" type="module" defer></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const nav = document.getElementById("sidebar-nav");
        if (nav) {
          // Restore scroll position
          const scrollPos = sessionStorage.getItem("sidebar-scroll");
          if (scrollPos) {
            nav.scrollTop = parseInt(scrollPos, 10);
          }

          // Save scroll position before leaving
          window.addEventListener("beforeunload", () => {
            sessionStorage.setItem("sidebar-scroll", nav.scrollTop);
          });
        }

        // Prevent details toggle when clicking link in summary
        document.querySelectorAll("details summary a").forEach((link) => {
          link.addEventListener("click", (e) => {
            e.stopPropagation();
          });
        });
      });
    </script>
  </body>
</html>
